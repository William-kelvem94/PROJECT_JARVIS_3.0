<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LocalJarvis</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Samsung+One:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <header class="app-bar">
      <div class="app-bar__left">
        <button class="icon-button" aria-label="Menu" onclick="toggleMenu()">
          <svg width="24" height="24" fill="none"><rect y="4" width="24" height="2" rx="1" fill="#E0E0E0"/><rect y="11" width="24" height="2" rx="1" fill="#E0E0E0"/><rect y="18" width="24" height="2" rx="1" fill="#E0E0E0"/></svg>
        </button>
        <h1 class="text-subhead">Jarvis 3.0</h1>
      </div>
      <div class="app-bar__right">
        <button class="avatar-button" onclick="openConfigModal()">
          <img src="/assets/microphone.png" alt="User">
        </button>
      </div>
    </header>
    <div class="app-container">
      <nav class="submenu">
        <button id="tab-chat" class="active" onclick="showTab('chat')">Assistente</button>
        <button id="tab-plugins" onclick="showTab('plugins')">Plugins</button>
        <button id="tab-treino" onclick="showTab('treino')">Treinar IA</button>
        <button id="tab-testes" onclick="showTab('testes')">Testes</button>
        <button id="tab-config" onclick="showTab('config')">Configurações</button>
      </nav>
      <section id="tab-content-chat">
        <div class="voice-card">
          <div class="voice-visualizer">
            <svg class="wave" viewBox="0 0 100 20"><polyline points="0,10 10,5 20,15 30,10 40,5 50,15 60,10 70,5 80,15 90,10 100,5" stroke="#7E57C2" stroke-width="2" fill="none"/></svg>
          </div>
          <button class="fab-button" id="mic-button" onclick="toggleRecording()">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
              <circle cx="16" cy="16" r="14" fill="#7E57C2"/>
              <rect x="12" y="8" width="8" height="14" rx="4" fill="#fff"/>
              <rect x="14.5" y="22" width="3" height="5" rx="1.5" fill="#fff"/>
              <rect x="10" y="27" width="12" height="2" rx="1" fill="#fff"/>
            </svg>
          </button>
          <p class="text-caption">Toque e fale</p>
        </div>
        <div class="chat-container" id="chat-box"></div>
        <div class="input-group" style="display:flex;gap:8px;align-items:center;">
          <textarea id="user-input" placeholder="Digite seu comando..." rows="2" style="flex:1;"></textarea>
          <button onclick="sendMessage()">Enviar</button>
        </div>
        <div class="brightness-control">
          <svg class="icon" width="20" height="20" fill="none"><circle cx="10" cy="10" r="8" stroke="#9E9E9E" stroke-width="2"/></svg>
          <input type="range" class="oneui-slider" min="0" max="100">
          <svg class="icon" width="20" height="20" fill="none"><circle cx="10" cy="10" r="8" stroke="#FFD600" stroke-width="2"/></svg>
        </div>
      </section>
      <section id="tab-content-plugins" style="display:none;">
        <h2 class="text-subhead">Plugins</h2>
        <div class="plugin-grid" id="plugin-list">
          <!-- Plugins renderizados dinamicamente -->
        </div>
      </section>
      <!-- Modal de Personalidade (opcional, não afeta config atual) -->
      <dialog id="personalityModal">
        <h2>Selecione uma Personalidade</h2>
        <div class="personality-grid">
          <div class="personality-card" data-personality="professional">
            <h3>Profissional</h3>
            <p>Respostas formais e técnicas</p>
          </div>
          <div class="personality-card" data-personality="friendly">
            <h3>Amigável</h3>
            <p>Tom casual e descontraído</p>
          </div>
        </div>
      </dialog>
      <!-- Painel de configurações avançado (opcional) -->
      <div class="settings-panel" style="display:none;">
        <div class="settings-category">
          <h3><svg width="20" height="20"><circle cx="10" cy="10" r="8" fill="#7E57C2"/></svg> Voz</h3>
          <div class="setting-item">
            <label>Velocidade de fala</label>
            <input type="range" min="0.5" max="2" step="0.1" value="1">
          </div>
        </div>
        <div class="settings-category">
          <h3><svg width="20" height="20"><rect x="4" y="4" width="12" height="12" fill="#4FC3F7"/></svg> Plugins</h3>
          <div class="plugin-toggle">
            <label>Plugin de Segurança</label>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider"></span>
            </label>
          </div>
        </div>
      </div>
      <!-- Visualizador de áudio (canvas, opcional) -->
      <canvas id="audioVisualizer" width="320" height="80" style="display:none;"></canvas>
      <section id="tab-content-treino" style="display:none;">
        <h2 class="text-subhead">Treinar IA</h2>
        <div class="train-group">
          <b>Digite no campo principal:</b><br>
          <span class="text-caption">treinar modelo &lt;nome&gt; com dataset &lt;dados do dataset em texto&gt;</span>
          <button onclick="trainModel()">Treinar</button>
          <div id="train-status"></div>
        </div>
      </section>
      <section id="tab-content-testes" style="display:none;">
        <h2 class="text-subhead">Testes Automatizados</h2>
        <button onclick="runTests()">Testar Sistema</button>
        <textarea id="test-output" rows="10" style="width:100%;margin-top:10px;"></textarea>
      </section>
      <section id="tab-content-config" style="display:none;">
        <div class="oneui-modal" style="position:static;max-width:100%;margin:0;box-shadow:none;background:transparent;">
          <div class="modal-header">
            <h2 class="text-headline">Configurações</h2>
          </div>
          <div class="modal-content">
            <div class="setting-item">
              <div class="setting-info">
                <h3 class="text-body">Tema escuro</h3>
                <p class="text-caption">Ativar modo noturno</p>
              </div>
              <label class="oneui-switch">
                <input type="checkbox" id="darkmode-toggle" checked onchange="toggleDarkMode()">
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>
      </section>
    </div>
    <script src="/app.js"></script>
    <script src="/chat.js"></script>
    <script>
      function showTab(tab) {
        ["chat","plugins","treino","testes","config"].forEach(t => {
          document.getElementById(`tab-content-${t}`).style.display = (t===tab)?'block':'none';
          document.getElementById(`tab-${t}`).classList.toggle('active', t===tab);
        });
      }
      function openConfigModal() {
        document.getElementById('config-modal').style.display = 'block';
      }
      function closeConfigModal() {
        document.getElementById('config-modal').style.display = 'none';
      }
      function toggleDarkMode() {
        document.body.classList.toggle('dark');
      }
      // Menu lateral futuro
      function toggleMenu() { alert('Menu lateral em breve!'); }
    </script>
</body>
</html>
